"use strict";function RamlExpander(){function a(a,b){if(a.types){var c=a.types.filter(function(a){return a[b]})[0];return c?c[b]:c}}function b(b,c,d){var e=d.example||d.examples,f=a(b,c);if(f)for(var g in f)if(f.hasOwnProperty(g)){if(["example","examples"].includes(g)&&e)continue;d[g]=f[g]}}function c(a){jsTraverse.traverse(a).forEach(function(c){if("body.application/json"===this.path.slice(-2).join(".")&&c.type){var d=c.type[0];b(a,d,c)}})}function d(a){return a.items.type?a.items.type[0]:a.items}function e(a){return null===a||"object"!=typeof a}function f(a){jsTraverse.traverse(a).forEach(function(c){if("body.application/json"===this.path.slice(-2).join(".")&&c.type&&"array"===c.type[0]){var f=d(c);e(c.items)&&(c.items={}),b(a,f,c.items),c.examples||c.example||g(c)}})}function g(a){var b=h(a.items);0!==b.length&&(a.example=b)}function h(a){return a.examples?a.examples.map(function(a){return a.structuredValue}):a.example?[a.example]:[]}function i(a){jsTraverse.traverse(a).forEach(function(b){if("body.application/json"===this.path.slice(-2).join(".")&&b.schema){var c=b.schema[0];j(a,c,b)}})}function j(a,b,c){var d=k(a,b);d&&(c.schema[0]=d.type[0])}function k(a,b){if(a.schemas){var c=a.schemas.filter(function(a){return a[b]})[0];return c?c[b]:c}}this.expandRaml=function(a){c(a),i(a),f(a)}}function RamlParser(a,b){function c(a){var b=a.toJSON(f);return b.specification&&d.expandRaml(b.specification),b}var d=new RamlExpander,e={attributeDefaults:!0,rejectOnErrors:!1,fsResolver:{contentAsync:a,content:function(a){throw new Error("RamlParser should call contentAsync instead of content. File: "+a)}}};b&&(e.httpResolver={getResourceAsync:function(a){return new Promise(function(c,d){var e=new XMLHttpRequest;e.open("GET",b+a),e.setRequestHeader("Accept","application/raml+yaml"),e.onload=function(){200===e.status?c({content:e.responseText}):d(e.status)},e.send()})}});var f={serializeMetadata:!1,dumpSchemaContents:!0,rootNodeDetails:!0};this.parse=function(a){return RAML.Parser.loadApi(a,e).then(function(a){return a=a.expand?a.expand(!0):a,c(a)})}}if(self.importScripts&&self.location.hash){var workerParameters=function(a){0===a.indexOf("#")&&(a=a.substring(1)),a=a.split("+").join(" ");var b,c={},d=/[?&]?([^=]+)=([^&]*)/g;for(b=d.exec(a);b;)c[decodeURIComponent(b[1])]=decodeURIComponent(b[2]),b=d.exec(a);return c}(self.location.hash);self.location.host.indexOf("localhost:9013")>-1?self.importScripts("/bower_components/raml-1-parser/raml-json-validation.js","/bower_components/raml-1-parser/raml-xml-validation.js","/bower_components/raml-1-parser/raml-1-parser.js","/.tmp/js-traverse/js-traverse.js"):self.importScripts(workerParameters.parser);var requestFileCallbacks={},post=function(a,b){try{self.postMessage({type:a,payload:b})}catch(c){console.error("Error when trying to post back from worker",c),self.postMessage({type:a})}},listen=function(a,b){self.addEventListener("message",function(c){c.data.type===a&&b(c.data.payload)},!1)},postReject=function(a,b){var c=b.stack?{message:b.message}:b;return post(a+"-reject",c)},listenThenPost=function(a,b){listen(a,function(c){try{b(c).then(function(b){return post(a+"-resolve",b)})["catch"](function(b){postReject(a,b)})}catch(d){postReject(a,d)}})},requestFile=function(a,b){var c=requestFileCallbacks[a]||[];c.push(b),requestFileCallbacks[a]=c,post("requestFile",{path:a})},responseFile=function(a,b,c){var d=requestFileCallbacks[a];d&&(d.forEach(function(a){a(b,c)}),delete requestFileCallbacks[a])},requestFilePromise=function(a){return new Promise(function(b,c){requestFile(a,function(a,d){a?c(a):b(d)})})},ramlParser=new RamlParser(requestFilePromise,workerParameters.proxy);listenThenPost("ramlParse",function(a){return ramlParser.parse(a.path)}),listen("requestFile",function(a){return responseFile(a.path,a.error,a.content)})}